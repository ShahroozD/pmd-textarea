!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PMdTextArea=t():e.PMdTextArea=t()}(this,()=>(()=>{"use strict";var e={365:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(601),a=n.n(r),o=n(314),i=n.n(o)()(a());i.push([e.id,"/* \nThis file is part of Shahneshan.\n\nCopyright (C) 2024 shahrooz saneidarani (github.com/shahroozD)\n\nShahneshan is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nShahneshan is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n  \n\n.task{\n  display: flex;\n  gap: 0.5em;\n}\n\n.task p {\n  margin: 0;\n}\n\n  \n/* table */\ntable {\n  border-collapse: collapse;\n}\ntable,\nth,\ntd {\n    border: 1.5px solid black;\n    padding: 0.2em 1em;\n}\n\ntable p {\n  margin: 0;\n}\n\ncode:not(pre code){\n  background: #f3f4f6;\n  padding: 0.125rem 0.25rem;\n  border-radius: 0.25rem;\n}\n\n.persian{\n  direction: rtl;\n}\n\n.poet{\n  margin: 1em 0;\n  font-style: italic;\n  display: grid;\n  column-gap: 2em;\n  grid-template-columns: calc(50% - 1em) calc(50% - 1em);\n\n}\n\n.poet > div:nth-child(even) {\n  text-align: right; /* Right-align content for odd-numbered columns */\n}\n\n.poet > div:nth-child(odd) {\n  text-align: left; /* Left-align content for even-numbered columns */\n}\n\n.شعر{\n  /* color: red; */\n}\n\n.alert{\n  margin: 10px 0;\n  padding: 10px;\n  border-right: 4px solid;\n  background-color: #ebebeb;\n}\n\n.alert h1, .alert p{\n  font-size: 16px;\n  margin: 0;\n}\n\n.alert h1{\n  margin-bottom: 6px;\n}\n\n.note{\n  border-color: #0044ff;\n}\n.note h1{\n  color: #0044ff;\n}\n.tip{\n  border-color: #1b7200;\n}\n.tip h1 {\n  color: #1b7200;\n}\n.important{\n  border-color: #9400b9;\n}\n.important h1 {\n  color: #9400b9;\n}\n.warning{\n  border-color: #866700;\n}\n.warning h1 {\n  color: #866700;\n}\n.caution{\n  border-color: #c20000;\n}\n.caution h1 {\n  color: #c20000;\n}\n",""]);const l=i},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,a,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(i[s]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&i[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),a&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=a):u[4]="".concat(a)),t.push(u))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},i=[],l=0;l<e.length;l++){var s=e[l],c=r.base?s[0]+r.base:s[0],u=o[c]||0,p="".concat(c," ").concat(u);o[c]=u+1;var d=n(p),h={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==d)t[d].references++,t[d].updater(h);else{var f=a(h,r);r.byIndex=l,t.splice(l,0,{identifier:p,updater:f,references:1})}i.push(p)}return i}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var o=r(e=e||[],a=a||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var l=n(o[i]);t[l].references--}for(var s=r(e,a),c=0;c<o.length;c++){var u=n(o[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=s}}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var r={};n.d(r,{f:()=>N,jK:()=>P,Mb:()=>O});const a=function(e){return Object.defineProperty(e,"prototype",{writable:!1}),e}(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.content=n,this.attributes=r,this.raw=a});var o={":tent:":"⛺",":joy:":"😂",":heart:":"❤️",":smile:":"😄",":thumbsup:":"👍",":grin:":"😁",":wink:":"😉",":blush:":"😊",":sunglasses:":"😎",":cry:":"😢",":sob:":"😭",":angry:":"😠",":astonished:":"😲",":scream:":"😱",":confused:":"😕",":tired_face:":"😫",":stuck_out_tongue:":"😛",":money_mouth_face:":"🤑",":thinking:":"🤔",":face_with_rolling_eyes:":"🙄",":neutral_face:":"😐",":expressionless:":"😑",":grinning:":"😀",":thumbsdown:":"👎",":clap:":"👏",":wave:":"👋",":pray:":"🙏",":ok_hand:":"👌",":muscle:":"💪",":peace:":"✌️",":100:":"💯",":fire:":"🔥",":poop:":"💩",":star:":"⭐",":sparkles:":"✨",":zap:":"⚡",":sunny:":"☀️",":cloud:":"☁️",":umbrella:":"☔",":snowflake:":"❄️",":cat:":"🐱",":dog:":"🐶",":rabbit:":"🐰",":panda_face:":"🐼",":koala:":"🐨",":pig:":"🐷",":monkey_face:":"🐵",":bird:":"🐦",":frog:":"🐸",":fish:":"🐟",":whale:":"🐳",":rocket:":"🚀",":airplane:":"✈️",":car:":"🚗",":taxi:":"🚕",":bus:":"🚌",":train:":"🚆",":bicycle:":"🚲",":soccer:":"⚽",":basketball:":"🏀",":football:":"🏈",":tennis:":"🎾",":video_game:":"🎮",":trophy:":"🏆",":bell:":"🔔",":gift:":"🎁",":balloon:":"🎈",":party_popper:":"🎉",":sparkler:":"🎇",":tada:":"🎉",":cake:":"🍰",":chocolate_bar:":"🍫",":coffee:":"☕",":beer:":"🍺",":wine_glass:":"🍷",":pizza:":"🍕",":hamburger:":"🍔",":fries:":"🍟",":spaghetti:":"🍝",":sushi:":"🍣",":apple:":"🍎",":banana:":"🍌",":cherry_blossom:":"🌸",":rose:":"🌹",":sunflower:":"🌻",":tulip:":"🌷",":cactus:":"🌵",":maple_leaf:":"🍁",":fallen_leaf:":"🍂",":leaves:":"🍃",":christmas_tree:":"🎄",":gift_heart:":"💝",":crown:":"👑",":kiss:":"💋",":lips:":"👄",":ring:":"💍",":gem:":"💎",":moneybag:":"💰",":camera:":"📷",":phone:":"📱",":laptop:":"💻",":hourglass:":"⌛",":bulb:":"💡",":mag:":"🔍",":lock:":"🔒",":key:":"🔑",":hammer:":"🔨",":wrench:":"🔧",":scissors:":"✂️",":pill:":"💊",":syringe:":"💉",":toilet:":"🚽",":bath:":"🛁",":hourglass_flowing_sand:":"⏳",":watch:":"⌚"};function i(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=e.replace(/\\([#*`_{}\[\]()\\])/g,"$1").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\[\^(\d+)\]/g,function(e,n){return t[n]?e:'<sup id="footnote-ref-'.concat(n,'"><a href="#footnote-').concat(n,'">[').concat(n,"]</a></sup>")}).replace(/\^(.+?)\^/g,"<sup>$1</sup>").replace(/~~(.+?)~~/g,"<del>$1</del>").replace(/~(.+?)~/g,"<sub>$1</sub>").replace(/==(.+?)==/g,"<mark>$1</mark>");return(n=/\[(.*?)\]\((.*?)\)/g.test(n)?n.replace(/\[(.*?)\]\((.*?)\)/g,function(e,t,n){return'<a href="'.concat(n,'">').concat(t,"</a>")}):/(?<!`)(https?:\/\/[^\s`]+)(?!`)/g.test(n)?n.replace(/(?<!`)(https?:\/\/[^\s`]+)(?!`)/g,function(e){return'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")}):n.replace(/`([^`]+?)`/g,function(e,t){return"<code>".concat(i(t),"</code>")})).replace(/:\w+:/g,function(e){return o[e]||e})}function c(e){for(var t=e.split("\n"),n=[],r={},o=[],i=!1,u="",p=!1,d="",h=null,f=0,v=function(e){var v,b=t[e],m=b.match(/^(\s*)/),y=m?m[1].length:0;if(/^```/.test(b))return i?(i=!1,u=""):(i=!0,u=b.replace(/^```/,"").trim(),n.push(new a("codeBlock",[],{lang:u}))),g=e,0;if(i)return n[n.length-1].content.push(b),g=e,0;if(/^\.{3}/.test(b)){var w={شعر:"poet",شعرنو:"poet",توجه:"note",نکته:"tip",مهم:"important",هشدار:"warning",احتیاط:"caution"};return p?p=!1:(p=!0,w[d=b.replace(/^\.{3}/,"").trim()]?(d=w[d],n.push(new a("persianBlock",[],{code:d}))):n.push(new a("persianBlock",[new a(d,b)],{code:d}))),g=e,0}if(p){var _=n[n.length-1];if("poet"===d){var C=b.split(" -- ").map(function(e){return e.trim()});_.content.push(new a("poetRow",C.map(function(e){return e&&new a("poetCell",e)})))}else["note","tip","important","warning","caution"].includes(d)?_.content.push(new a(d,c(b))):_.content.push(new a(d,b));return g=e,0}if(/^> /.test(b)){var S,A=b.replace(/^> /,"").trim();return h||(h=new a("blockquote",[]),n.push(h)),(S=h.content).push.apply(S,function(e){if(Array.isArray(e))return l(e)}(v=c(A))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(v)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=e,0}h=null;var T=b.match(/^(#{1,6}) (.*)/);if(T){var k=T[1].length,x=s(T[2],r),E=T[2].replace(/\\([\\`*_{}\[\]()#+\-.!>])/g,"$1").replace(/!\[.*?\]\(.*?\)/g,"").replace(/\[([^\]]+?)\]\(.*?\)/g,"$1").replace(/\*\*(.+?)\*\*/g,"$1").replace(/__(.+?)__/g,"$1").replace(/\*(.+?)\*/g,"$1").replace(/_(.+?)_/g,"$1").replace(/~~(.+?)~~/g,"$1").replace(/==(.+?)==/g,"$1").replace(/`([^`]+?)`/g,"$1").replace(/\[\^\d+\]/g,"").replace(/^#{1,6}\s*(.+)$/gm,"$1").replace(/^\s*>+\s?/gm,"").replace(/[*_~`>#\[\]\(\)\-!]/g,"").replace(/\s{2,}/g," ").trim();return n.push(new a("header",[new a("paragraph",x)],{level:k},E)),g=e,0}if(/^(-{3,}|\*{3,}|_{3,})$/.test(b))return n.push(new a("hr")),g=e,0;var R=b.match(/^\[\^(\d+)\]:\s+(.*)$/);if(R){var F=R[1],P=R[2];return r[F]=P,g=e,0}var O=b.match(/^\s*[-+*] \[( |x)\] (.*)/);if(O){var N="x"===O[1],D=O[2],M=/^[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*[\*\+\x2D] \[(?: |x)\][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*[\u0590-\u06FF]/.test(b),L=new a("taskItem",c(D),{checked:N,isRTL:M});if(0===o.length||"ul"!==o[o.length-1].type){var j=new a("ul",[],{isRTL:M});n.push(j),o.push(j)}return o[o.length-1].content.push(L),g=e,0}var H=b.match(/!\[(.*?)\]\((.*?)\)/);if(H){var $=H[1],I=H[2];return n.push(new a("image","",{src:I,alt:$})),g=e,0}if(/^\s*<([a-z][\w-]*)(\s[^>]*)?\/>\s*$/i.test(b))return console.log("line",b),n.push(new a("html",b)),g=e,0;if(/^\|\s*(.+)\s*\|\s*$/.test(b)){for(var W=[],B=e;B<t.length&&/^\|\s*(.+)\s*\|\s*$/.test(t[B]);)W.push(t[B]),B++;var q=[];W.length>=2&&/^\|\s*[:\-]+(?:\s*\|\s*[:\-]+)*\s*\|$/.test(W[1].trim())&&(q=W[1].trim().slice(1,-1).split("|").map(function(e){return e.trim()}).map(function(e){var t=e.startsWith(":"),n=e.endsWith(":");return t&&n?"center":t?"left":n?"right":"left"}),W.splice(1,1));var X=new a("table",[]);return W.forEach(function(e,t){var n=0===t&&q.length>0,r=e.match(/^\|\s*(.+)\s*\|\s*$/)[1].split("|").map(function(e){return e.trim()}).map(function(e,t){var r=c(e),o=n?"tableHeaderCell":"tableCell",i={};return q[t]&&(i.align=q[t]),new a(o,r,i)});X.content.push(new a("tableRow",r))}),n.push(X),g=e=B,0}if(/^\s*[-*]\s(.*)/.test(b)){var z=b.replace(/^\s*[-*]\s(.*)/,"$1"),U={isRTL:/^[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*[\*\x2D][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*[\u0590-\u06FF]/.test(b)},K=new a("li",c(z),U);if(y>f){var G=new a("ul",[],U);o.length>0?o[o.length-1].content.push(G):n.push(G),o.push(G)}else if(y<f)for(;o.length>0&&y<f;)o.pop(),f-=4;if(0===o.length||"ul"!==o[o.length-1].type){var Y=new a("ul",[],U);n.push(Y),o.push(Y)}return o[o.length-1].content.push(K),f=y,g=e,0}if(/^\s*[0-9\u06F0-\u06F9]+\.\s(.*)/.test(b)){var V=b.replace(/^\s*[0-9\u06F0-\u06F9]+\.\s(.*)/,"$1"),J={isRTL:/^[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*[0-9\u06F0-\u06F9]+\.[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*[\u0590-\u06FF]/.test(b)},Z=new a("li",c(V),J);if(y>f){var Q=new a("ol",[],J);o.length>0?o[o.length-1].content.push(Q):n.push(Q),o.push(Q)}else if(y<f)for(;o.length>0&&y<f;)o.pop(),f-=4;if(0===o.length||"ol"!==o[o.length-1].type){var ee=new a("ol",[],J);n.push(ee),o.push(ee)}return o[o.length-1].content.push(Z),f=y,g=e,0}for(;o.length;)o.pop();var te=s(b,r);b.trim()&&n.push(new a("paragraph",te)),g=e},g=0;g<t.length;g++)v(g);for(;o.length;)o.pop();if(f=0,o.length=0,Object.keys(r).length>0){var b=new a("footnotes",Object.keys(r).map(function(e){return new a("footnote",r[e],{ref:e})}));n.push(b)}return n}function u(e){return e.map(function(e){return function(e){switch(e.type){case"header":return"<h".concat(e.attributes.level,' id="').concat(e.raw.toLowerCase().replace(/\s+/g,"-"),'">').concat(u(e.content),"</h").concat(e.attributes.level,">");case"paragraph":return"<p dir='auto' >".concat(e.content,"</p>");case"blockquote":return"<blockquote>".concat(u(e.content),"</blockquote>");case"ul":return"<ul dir='".concat(e.attributes.isRTL?"rtl":"ltr","'>").concat(u(e.content),"</ul>");case"ol":return"<ol dir='".concat(e.attributes.isRTL?"rtl":"ltr","'>").concat(u(e.content),"</ol>");case"li":return"<li dir='".concat(e.attributes.isRTL?"rtl":"ltr","'>").concat(u(e.content),"</li>");case"codeBlock":var t=e.content.join("\n");return'<pre><code class="'.concat(e.attributes.lang,'">').concat(i(t),"</code></pre>");case"persianBlock":return'<div class="persian '.concat(e.attributes.code,'">').concat(u(e.content),"</div>");case"poetRow":return"".concat(u(e.content));case"poetCell":return'<div class="stanza">'.concat(e.content,"</div>");case"note":return'<div class="alert note"><h1>توجه</h1><p>'.concat(u(e.content),"</p></div>");case"tip":return'<div class="alert tip"><h1>نکته</h1><p>'.concat(u(e.content),"</p></div>");case"important":return'<div class="alert important"><h1>مهم</h1><p>'.concat(u(e.content),"</p></div>");case"warning":return'<div class="alert warning"><h1>هشدار</h1><p>'.concat(u(e.content),"</p></div>");case"caution":return'<div class="alert caution"><h1>احتیاط</h1><p>'.concat(u(e.content),"</p></div>");case"hr":return"<hr />";case"taskItem":return"<li dir='".concat(e.attributes.isRTL?"rtl":"ltr",'\' class="task"><input type="checkbox" ').concat(e.attributes.checked?"checked":""," disabled> ").concat(u(e.content),"</li>");case"table":return"<table>".concat(u(e.content),"</table>");case"tableRow":return"<tr>".concat(u(e.content),"</tr>");case"tableHeaderCell":return'<th align="'.concat(e.attributes.align,'">').concat(u(e.content),"</th>");case"tableCell":return'<td align="'.concat(e.attributes.align,'">').concat(u(e.content),"</td>");case"image":return'<img src="'.concat(e.attributes.src,'" alt="').concat(e.attributes.alt,'">');case"html":return e.content;case"footnotes":return"<section dir='auto' class=\"footnotes\"><h2>Footnotes</h2><ol>".concat(u(e.content),"</ol></section>");case"footnote":return'<li id="footnote-'.concat(e.attributes.ref,'">').concat(e.content,' <a href="#footnote-ref-').concat(e.attributes.ref,'">↩</a></li>');default:return e.content?"\n".concat(e.content,"\n"):""}}(e)}).join("")}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}var h=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugins=[]},t=[{key:"addPlugin",value:function(e){this.plugins.includes(e)||this.plugins.push(e)}},{key:"applyBeforeParse",value:function(e){return this.plugins.reduce(function(e,t){return t.beforeParse?t.beforeParse(e):e},e)}},{key:"applyNodeTransform",value:function(e){return this.plugins.reduce(function(e,t){return t.nodeTransform?t.nodeTransform(e):e},e)}},{key:"applyAfterParse",value:function(e){return this.plugins.reduce(function(e,t){return t.afterParse?t.afterParse(e):e},e)}},{key:"applyAfterRender",value:function(e){this.plugins.forEach(function(t){t.afterRender&&t.afterRender(e)})}}],t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();const f=h;var v=n(72),g=n.n(v),b=n(825),m=n.n(b),y=n(659),w=n.n(y),_=n(56),C=n.n(_),S=n(540),A=n.n(S),T=n(113),k=n.n(T),x=n(365),E={};E.styleTagTransform=k(),E.setAttributes=C(),E.insert=w().bind(null,"head"),E.domAPI=m(),E.insertStyleElement=A(),g()(x.A,E),x.A&&x.A.locals&&x.A.locals;var R={customStyles:""},F=new f;function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(R,e),e.plugins&&Array.isArray(e.plugins)&&e.plugins.forEach(function(e){return F.addPlugin(e)})}function O(e){var t=c(F.applyBeforeParse(e));t=t.map(function(e){return F.applyNodeTransform(e)});var n=u(t);return F.applyAfterParse(n)}function N(e){F.applyAfterRender(e)}var D=r.Mb;function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,W(r.key),r)}}function j(e){var t="function"==typeof Map?new Map:void 0;return j=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(H())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var a=new(e.bind.apply(e,r));return n&&$(a,n.prototype),a}(e,arguments,I(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),$(n,e)},j(e)}function H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(H=function(){return!!e})()}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function W(e){var t=function(e){if("object"!=M(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==M(t)?t:t+""}function B(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function q(e,t){return e.get(z(e,t))}function X(e,t,n){return e.set(z(e,t),n),n}function z(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var U=new WeakMap,K=new WeakMap,G=new WeakMap,Y=new WeakMap,V=new WeakMap,J=new WeakMap,Z=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),B(e=function(e,t,n){return t=I(t),function(e,t){if(t&&("object"==M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,H()?Reflect.construct(t,n||[],I(e).constructor):t.apply(e,n))}(this,t),U,null),B(e,K,!1),B(e,G,"rtl"),B(e,Y,null),B(e,V,null),B(e,J,[]),function(e,t,n){(t=W(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(e,"_suppressSelectionChange",!1),e._onCut=e._onCut.bind(e),e._onCopy=e._onCopy.bind(e),e._onPaste=e._onPaste.bind(e),e._onInput=e._onInput.bind(e),e._onKeyDown=e._onKeyDown.bind(e),e._onFocusIn=e._onFocusIn.bind(e),e._onFocusOut=e._onFocusOut.bind(e),e._onSelectAll=e._onSelectAll.bind(e),e._onSelectionChange=e._onSelectionChange.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(t,e),function(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"attributeChangedCallback",value:function(e,t,n){switch(e){case"placeholder":this._updatePlaceholder();break;case"value":this.value=n;break;case"default-direction":X(G,this,"ltr"===n?"ltr":"rtl"),this._updateParagraphDirs()}}},{key:"connectedCallback",value:function(){if(!q(K,this)){X(K,this,!0);var e=this.attachShadow({mode:"open"});if(e.innerHTML=t.template,!this._shahneshanCloned){var n=Array.from(document.head.querySelectorAll("style")).find(function(e){return e.textContent.includes("This file is part of Shahneshan")});n&&this.shadowRoot.appendChild(n.cloneNode(!0)),this._shahneshanCloned=!0}this.editable=e.querySelector(".editable"),this.editable.innerHTML="<span><p>​</p></span>",this.editable.addEventListener("input",this._onInput),this.editable.addEventListener("keydown",this._onKeyDown),this.editable.addEventListener("focusin",this._onFocusIn),this.editable.addEventListener("focusout",this._onFocusOut),this.editable.addEventListener("paste",this._onPaste.bind(this)),document.addEventListener("selectionchange",this._onSelectionChange),this._updatePlaceholder(),this._updatePlaceholderState(),this._hasPendingValue?(this.value=q(U,this),X(U,this,null)):this.hasAttribute("value")&&(this.value=this.getAttribute("value"))}}},{key:"disconnectedCallback",value:function(){document.removeEventListener("selectionchange",this._onSelectionChange)}},{key:"splitSpanAtCursor",value:function(){var e=this.shadowRoot.getSelection();if(!e.rangeCount)return null;var t=e.getRangeAt(0),n=function(e,t){var n=e.nodeType===Node.TEXT_NODE?e:e.childNodes[t]||e;return n.nodeType===Node.TEXT_NODE?n.parentNode.closest("span"):n.closest("span")},r=n(t.startContainer,t.startOffset),a=n(t.endContainer,t.endOffset);if(!r||!a)return null;var o=function(e,t,n){for(var r,a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),o=0;r=a.nextNode();){if(r===t)return o+n;o+=r.textContent.length}return 0},i=r.getAttribute("data-original")||"",l=a.getAttribute("data-original")||"",s=o(r,t.startContainer,t.startOffset),c=o(a,t.endContainer,t.endOffset);return{before:i.slice(0,s),after:l.slice(c),firstSpan:r,lastSpan:a}}},{key:"_onSelectAll",value:function(){var e=this.shadowRoot.getSelection();e.removeAllRanges(),this.editable.querySelectorAll("span").forEach(function(e){e.textContent=e.getAttribute("data-original")||""});var t=document.createRange();t.selectNodeContents(this.editable),e.addRange(t)}},{key:"_onCopy",value:function(e){if(e.preventDefault(),this.shadowRoot.getSelection().rangeCount){var t=this._saveSelection();if(t){var n=this.value.slice(t.start,t.end);e.clipboardData.setData("text/plain",n)}}}},{key:"_onCut",value:function(e){e.preventDefault(),this._onCopy(e);var t=this.shadowRoot.getSelection();t.rangeCount&&(t.getRangeAt(0).deleteContents(),this._updatePlaceholderState(),this._updateParagraphDirs(),this.dispatchEvent(new Event("input")))}},{key:"_onInput",value:function(e){var t=this.shadowRoot.getSelection();if(t.rangeCount){var n=t.anchorNode;n.nodeType===Node.TEXT_NODE&&(n=n.parentNode);var r=n.closest("span");r&&r.setAttribute("data-original",r.textContent)}this._updatePlaceholderState(),this._updateParagraphDirs(),this.dispatchEvent(new Event("input"))}},{key:"_onKeyDown",value:function(e){if((e.ctrlKey||e.metaKey)&&"a"===e.key.toLowerCase())return e.preventDefault(),void this._onSelectAll();if("Enter"===e.key)this._onEnter(e);else{if("Backspace"!==e.key&&"Delete"!==e.key)return;this._onRemove(e)}}},{key:"_onEnter",value:function(e){var t,n;e.preventDefault(),this.editable.focus();var r=this.shadowRoot.getSelection();if(r.rangeCount){var a=r.getRangeAt(0),o=a.startContainer;o.nodeType===Node.TEXT_NODE&&(o=o.parentNode);var i=o.closest("span"),l=null!==(t=null==i?void 0:i.getAttribute("data-original"))&&void 0!==t?t:i.textContent,s=/^(```|\.\.\.)/.test(l.trim()),c=/^[\d\u06F0-\u06F9]+\.\s/.test(l),u=/^\s*\|\s*([^|]+\|)+/.test(l),p=l.endsWith("\n\n");if((s||c||u)&&!p){var d=l+"\n\n";i.setAttribute("data-original",d),i.textContent=d;var h=function(){for(var e=i;e.lastChild&&e.lastChild.nodeType!==Node.TEXT_NODE;)e=e.lastChild;return e.nodeType===Node.TEXT_NODE?e:i.appendChild(document.createTextNode(""))}(),f=document.createRange();return f.setStart(h,h.textContent.length),f.collapse(!0),r.removeAllRanges(),r.addRange(f),this._updatePlaceholderState(),this._updateParagraphDirs(),void this.dispatchEvent(new Event("input"))}var v=a.startOffset,g=l.slice(0,v),b=l.slice(v),m=null!==(n=null==i?void 0:i.getAttribute("data-original"))&&void 0!==n?n:o.textContent,y=this.detectDir(m)||q(G,this);g.trim()?(i.setAttribute("data-original",g),i.innerHTML=D(g)):i.innerHTML="<p>​</p>";var w=document.createElement("span");w.dir=y,w.setAttribute("data-original",b);var _=document.createElement("p");_.innerHTML=b||"​",w.appendChild(_),i&&i.parentNode?i.parentNode.insertBefore(w,i.nextSibling):(a.deleteContents(),a.insertNode(w));var C=document.createRange(),S=_.firstChild;S&&"BR"!==S.nodeName||(S=document.createTextNode(""),_.appendChild(S)),C.setStart(S,0),C.collapse(!0),r.removeAllRanges(),r.addRange(C),this._updatePlaceholderState(),this._updateParagraphDirs(),this.dispatchEvent(new Event("input"))}}},{key:"_onRemove",value:function(e){var t;e.preventDefault();var n=this.shadowRoot.getSelection();if(n.rangeCount){var r=n.getRangeAt(0),a=r.startContainer;a.nodeType===Node.TEXT_NODE&&(a=a.parentNode);var o=a.closest("span");if(o){var i=null!==(t=o.getAttribute("data-original"))&&void 0!==t?t:o.textContent,l=r.startOffset;if(this.editable.focus(),r.collapsed){var s;if("Backspace"===e.key){if(0===l){var c=o.previousElementSibling;if(console.log("prev",c),c){var u,p=null!==(u=c.getAttribute("data-original"))&&void 0!==u?u:c.textContent,d=p+i;c.setAttribute("data-original",d),c.innerHTML="<p>".concat(d,"</p>"),o.remove(),this._placeCaret(c,p.length)}return}s=i.slice(0,l-1)+i.slice(l),l-=1}else{if(l>=i.length){var h=o.nextElementSibling;if(h){var f,v=i+(null!==(f=h.getAttribute("data-original"))&&void 0!==f?f:h.textContent);o.setAttribute("data-original",v),o.innerHTML=v,h.remove(),this._placeCaret(o,i.length)}return}s=i.slice(0,l)+i.slice(l+1)}o.setAttribute("data-original",s),o.innerHTML=null!=s?s:"<p>​</p>",this._placeCaret(o,l)}else{r.deleteContents(),this.editable.querySelectorAll("span").forEach(function(e){e.textContent.trim()||e.remove()});var g=document.createElement("span"),b=g.textContent;g.setAttribute("data-original",b),g.innerHTML=b||"<p>​</p>",r.insertNode(g),this._placeCaret(g,l)}if(this._updatePlaceholderState(),this._updateParagraphDirs(),!this.editable.querySelector("span").innerHTML){this.editable.innerHTML="";var m=document.createElement("span");m.dir=q(G,this),m.setAttribute("data-original",""),m.innerHTML="<p> </p>",this.editable.appendChild(m),this._placeCaret(m,0)}this.dispatchEvent(new Event("input"))}}}},{key:"_onFocusIn",value:function(e){}},{key:"_onFocusOut",value:function(e){}},{key:"_onSelectionChange",value:function(){var e=this;if(this._suppressSelectionChange)this._suppressSelectionChange=!1;else{var t=this.shadowRoot.getSelection();if(t.rangeCount){var n=t.getRangeAt(0);if(this.editable.contains(n.startContainer)||this.editable.contains(n.endContainer)){var r=n.startContainer;if(r.nodeType===Node.TEXT_NODE&&(r=r.parentNode),X(V,this,r.closest("span")),q(V,this)){var a=Array.from(this.editable.querySelectorAll("span")),o=a.indexOf(q(V,this)),i=a.filter(function(e){var t=document.createRange();return t.selectNodeContents(e),n.compareBoundaryPoints(Range.END_TO_START,t)<0&&n.compareBoundaryPoints(Range.START_TO_END,t)>0});q(J,this).filter(function(e){return!i.includes(e)}).forEach(function(t){return e._renderSpan(t)});var l=this._saveSelection();i.filter(function(t){return!q(J,e).includes(t)}).forEach(function(e){var t,n=null!==(t=e.getAttribute("data-original"))&&void 0!==t?t:e.textContent,r="#"==(null==n?void 0:n.charAt(0))?e.children[0]:e;n.trim()&&(r.innerHTML=n)}),X(J,this,i);var s=q(Y,this)!=o;this._suppressSelectionChange=!0,this._restoreSelection(l,s),X(Y,this,o)}}else q(V,this)&&(q(J,this).forEach(function(t){return e._renderSpan(t)}),X(J,this,[]))}}}},{key:"_onPaste",value:function(e){e.preventDefault();var t=e.clipboardData.getData("text/plain");if(t){var n=this.splitSpanAtCursor();if(n){var r=n.before,a=n.after,o=n.firstSpan,i=n.lastSpan,l=o.parentNode,s=t.split(/\r\n|\r|\n/),c=document.createDocumentFragment(),u=r+s[0],p=document.createElement("span");p.dir=this.detectDir(u),p.setAttribute("data-original",u),p.innerHTML=D(u),c.appendChild(p);for(var d="",h=!1,f=1;f<s.length;f++){var v=s[f],g=v.trim(),b=/^(```|\.\.\.)/.test(g),m=/^[\d\u06F0-\u06F9]+\.\s/m.test(g),y=/^\s*\|\s*([^|]+\|)+/.test(g);if(d+="".concat(v,"\n"),!(m||(b||y||h)&&((b||y)&&(h=!h),h))){var w=document.createElement("span");w.dir=this.detectDir(d),w.setAttribute("data-original",d),w.innerHTML=D(d),c.appendChild(w),d=""}}var _=c.lastChild,C=_.getAttribute("data-original")+a;_.setAttribute("data-original",C),_.innerHTML=D(C),l.insertBefore(c,o);for(var S=o;S;){var A=S.nextSibling;if(l.removeChild(S),S===i)break;S=A}var T=C.length-a.length;this._placeCaret(_,T),this._updatePlaceholderState(),this._updateParagraphDirs(),this.dispatchEvent(new Event("input"))}}}},{key:"_hasPendingValue",get:function(){return null!==q(U,this)}},{key:"_placeCaret",value:function(e,t){var n=this.shadowRoot.getSelection();n.removeAllRanges();var r=document.createRange(),a=e.firstChild;a&&a.nodeType===Node.TEXT_NODE||(a=document.createTextNode(e.textContent),e.innerHTML="",e.appendChild(a));var o=Math.min(t,a.textContent.length);r.setStart(a,o),r.collapse(!0),n.addRange(r)}},{key:"_updatePlaceholder",value:function(){var e,t=this.getAttribute("placeholder")||"";null===(e=this.editable)||void 0===e||e.setAttribute("data-placeholder",t)}},{key:"_isEmpty",value:function(){var e=this.editable.textContent.trim();return""===e||"​"===e}},{key:"_updatePlaceholderState",value:function(){this.editable.setAttribute("data-empty",this._isEmpty())}},{key:"detectDir",value:function(e){if(!e)return q(G,this);var t=e.replace(/^[\s]*(?:[#>*_\-+~`]+|\d+\.)[\s]*/g,"").charAt(0);return t?"rtl"===q(G,this)?/[A-Za-z0-9]/.test(t)?"ltr":"rtl":/[\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(t)?"rtl":"ltr":q(G,this)}},{key:"_updateParagraphDirs",value:function(){var e=this;this.editable.querySelectorAll("span").forEach(function(t){var n=t.getAttribute("data-original");t.dir=e.detectDir(n)})}},{key:"_renderAllSpans",value:function(){var e=this;this.editable.querySelectorAll("span").forEach(function(t){return e._renderSpan(t)})}},{key:"_renderSpan",value:function(e){if(e){var t=e.getAttribute("data-original")||e.textContent;t.trim()&&(e.setAttribute("data-original",t),e.innerHTML=D(t),e.dir=this.detectDir(t))}}},{key:"value",get:function(){return Array.from(this.editable.querySelectorAll("span")).map(function(e){var t;return null!==(t=e.getAttribute("data-original"))&&void 0!==t?t:e.textContent}).join("\n")},set:function(e){var t=this;if(this.editable){var n=String(e||"").split("\n");this.editable.innerHTML=n.map(function(e){var n=t.detectDir(e),r=e.replace(/"/g,"&quot;");return'<span dir="'.concat(n,'" data-original="').concat(r,'">').concat(D(e),"</span>")}).join(""),this._updatePlaceholderState()}else X(U,this,e)}},{key:"_saveSelection",value:function(){var e=this.shadowRoot.getSelection();if(!e.rangeCount)return null;var t=e.getRangeAt(0),n=Array.from(this.editable.children),r=function(e){return document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1)},a=function(e,t){for(var a=0,o=0,i=n;o<i.length;o++){for(var l=i[o],s=r(l),c=void 0;c=s.nextNode();){if(c===e)return a+Math.min(Math.max(t,0),c.textContent.length);a+=c.textContent.length}a+=1}return a};return{start:a(t.startContainer,t.startOffset),end:a(t.endContainer,t.endOffset)}}},{key:"_restoreSelection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){var n=e.start,r=e.end,a=this.shadowRoot.getSelection();a.removeAllRanges();for(var o=document.createRange(),i=Array.from(this.editable.children),l=function(e){return document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1)},s=0,c=!1,u=0,p=0;p<i.length;p++){for(var d=l(i[p]),h=void 0;h=d.nextNode();){var f=h.textContent.length;if(!c&&n<=s+f){var v=Math.min(Math.max(n-s,0),f);o.setStart(h,v),c=!0}if(c&&r<=s+f){var g=Math.min(Math.max(r-s,0),f);if(t){var b=h.textContent.slice(0,g),m={star:(b.match(/\*/g)||[]).length,tilde:(b.match(/~/g)||[]).length,backtick:(b.match(/`/g)||[]).length};3===Object.values(m).filter(function(e){return e%2==0}).length&&(u=Object.values(m).reduce(function(e,t){return e+t},0))}return o.setEnd(h,g+u),u>0&&o.setStart(h,o.startOffset+u),void a.addRange(o)}s+=f}p<i.length-1&&(s+=1)}var y=i[i.length-1];this._placeCaret(y,y.textContent.length)}}},{key:"setSelectionRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.editable){var n=document.createRange(),r=this.shadowRoot.getSelection();r.removeAllRanges();for(var a=0,o=null,i=null,l=document.createTreeWalker(this.editable,NodeFilter.SHOW_TEXT);l.nextNode();){var s=l.currentNode,c=s.textContent.length;if(!o&&a+c>=e&&(o=s,n.setStart(s,e-a)),!i&&a+c>=t){i=s,n.setEnd(s,t-a);break}a+=c}o||(o=this.editable),i||(i=this.editable),r.addRange(n)}}}],[{key:"observedAttributes",get:function(){return["placeholder","value","default-direction"]}},{key:"template",get:function(){return'\n      <div class="editable" contenteditable="true"></div>\n      <style>\n        :host {\n          display: block;\n          border: 1px solid #ccc;\n          height: 100%;\n        }\n        .editable {\n          outline: none;\n          padding: 10px;\n          box-sizing: border-box;\n          width: 100%;\n          height: 100%;\n          min-width: 90px;\n          min-height: 150px;\n          white-space: pre-wrap;\n          position: relative;\n        }\n        .editable[data-empty="true"]::before {\n          content: attr(data-placeholder);\n          color: #aaa;\n          position: absolute;\n          top: 10px;\n          left: 10px;\n          pointer-events: none;\n          white-space: pre-wrap;\n        }\n        .editable span {\n          display: block;\n          margin-bottom: 10px;\n        }\n        .editable span:last-child {\n          margin-bottom: 0;\n        }\n                  .editable[data-empty="true"]::before {\n          content: attr(data-placeholder);\n          color: #aaa;\n          pointer-events: none;\n          display: block;\n          white-space: pre-wrap;\n          position: absolute;\n        }\n        .editable span p {\n          margin: 0 0 10px;\n        }\n\n        .editable ul, \n        .editable ol,\n        .editable li p{\n          margin: 0;\n        }\n\n        .editable blockquote{\n          margin: 0 40px;\n        }\n      </style>\n    '}}])}(j(HTMLElement));return customElements.define("pmd-textarea",Z),{}})());